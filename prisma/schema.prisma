generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Admin {
  id           String    @id @default(cuid())
  email        String    @unique
  passwordHash String
  name         String
  createdAt    DateTime  @default(now())
  sessions     Session[]

  @@map("admins")
}

model Session {
  id        String   @id @default(cuid())
  adminId   String
  token     String   @unique
  expiresAt DateTime
  createdAt DateTime @default(now())
  admin     Admin    @relation(fields: [adminId], references: [id], onDelete: Cascade)

  @@index([adminId])
  @@map("sessions")
}

model Partner {
  id            String   @id @default(cuid())
  name          String
  nameEn        String?  // English translation
  description   String?
  descriptionEn String?  // English translation
  logoUrl       String?
  type          String
  websiteUrl    String?
  displayOrder  Int      @default(0)
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([type])
  @@index([displayOrder])
  @@map("partners")
}

model Project {
  id                    String           @id @default(cuid())
  title                 String
  titleEn               String?          // English translation
  slug                  String?          @unique
  shortDescription      String
  shortDescriptionEn    String?          // English translation
  detailedDescription   String?
  detailedDescriptionEn String?          // English translation
  imageUrl              String?          // Project cover image
  status                String?
  startDate             DateTime?
  endDate               DateTime?
  displayOrder          Int              @default(0)
  isActive              Boolean          @default(true)
  createdAt             DateTime         @default(now())
  updatedAt             DateTime         @updatedAt
  news                  News[]
  sections              ProjectSection[]

  @@index([status])
  @@index([displayOrder])
  @@map("projects")
}

model ProjectSection {
  id              String               @id @default(cuid())
  projectId       String
  title           String?              // Optional section title
  titleEn         String?              // English translation
  content         String?              // Rich text content
  contentEn       String?              // English translation
  backgroundColor String?              // Background color for the section
  displayOrder    Int                  @default(0)
  createdAt       DateTime             @default(now())
  updatedAt       DateTime             @updatedAt
  project         Project              @relation(fields: [projectId], references: [id], onDelete: Cascade)
  files           ProjectSectionFile[]

  @@index([projectId])
  @@index([displayOrder])
  @@map("project_sections")
}

model ProjectSectionFile {
  id              String          @id @default(cuid())
  sectionId       String
  fileName        String
  fileUrl         String
  fileSize        Int
  mimeType        String
  createdAt       DateTime        @default(now())
  section         ProjectSection  @relation(fields: [sectionId], references: [id], onDelete: Cascade)

  @@index([sectionId])
  @@map("project_section_files")
}

model Event {
  id                    String              @id @default(cuid())
  title                 String
  titleEn               String?             // English translation
  slug                  String?             @unique
  type                  String?
  shortDescription      String?
  shortDescriptionEn    String?             // English translation
  detailedDescription   String?
  detailedDescriptionEn String?             // English translation
  imageUrl              String?
  eventDate             DateTime?
  dateText              String?             // For date ranges like "Iunie - August 2025"
  dateTextEn            String?             // English translation (e.g., "June - August 2025")
  location              String?
  locationEn            String?             // English translation
  displayOrder          Int                 @default(0)
  isActive              Boolean             @default(true)
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @updatedAt
  registrations         EventRegistration[]
  news                  News[]
  sections              EventSection[]

  @@index([eventDate])
  @@index([displayOrder])
  @@map("events")
}

model EventSection {
  id              String              @id @default(cuid())
  eventId         String
  title           String?             // Optional section title (e.g., "Course Description", "Programme")
  titleEn         String?             // English translation
  content         String?             // Rich text content
  contentEn       String?             // English translation
  backgroundColor String?             // Background color for the section (e.g., "white", "primary", "muted")
  displayOrder    Int                 @default(0)
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  event           Event               @relation(fields: [eventId], references: [id], onDelete: Cascade)
  files           EventSectionFile[]

  @@index([eventId])
  @@index([displayOrder])
  @@map("event_sections")
}

model EventSectionFile {
  id              String        @id @default(cuid())
  sectionId       String
  fileName        String
  fileUrl         String
  fileSize        Int
  mimeType        String
  createdAt       DateTime      @default(now())
  section         EventSection  @relation(fields: [sectionId], references: [id], onDelete: Cascade)

  @@index([sectionId])
  @@map("event_section_files")
}

model EventRegistration {
  id        String   @id @default(cuid())
  eventId   String
  name      String
  email     String
  createdAt DateTime @default(now())
  event     Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@index([eventId])
  @@map("event_registrations")
}

model Resource {
  id            String         @id @default(cuid())
  title         String
  titleEn       String?        // English translation
  slug          String?        @unique
  description   String
  descriptionEn String?        // English translation
  url           String?
  type          String
  isActive      Boolean        @default(true)
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  news          News[]
  files         ResourceFile[]

  @@index([type])
  @@map("resources")
}

model ResourceFile {
  id         String   @id @default(cuid())
  resourceId String
  fileName   String
  fileUrl    String
  fileSize   Int
  mimeType   String
  createdAt  DateTime @default(now())
  resource   Resource @relation(fields: [resourceId], references: [id], onDelete: Cascade)

  @@index([resourceId])
  @@map("resource_files")
}

model ContactSubmission {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String
  message   String
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([isRead])
  @@index([createdAt])
  @@map("contact_submissions")
}

model CarouselImage {
  id           String   @id @default(cuid())
  imageUrl     String
  alt          String
  altEn        String?  // English translation
  displayOrder Int      @default(0)
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([displayOrder])
  @@index([isActive])
  @@map("carousel_images")
}

model News {
  id           String    @id @default(cuid())
  title        String
  titleEn      String?   // English translation
  slug         String?   @unique // URL-friendly slug
  excerpt      String?
  excerptEn    String?   // English translation
  content      String?
  contentEn    String?   // English translation
  linkType     String
  linkUrl      String?
  eventId      String?
  projectId    String?
  resourceId   String?
  displayOrder Int       @default(0)
  isActive     Boolean   @default(true)
  publishedAt  DateTime  @default(now())
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  event        Event?    @relation(fields: [eventId], references: [id])
  project      Project?  @relation(fields: [projectId], references: [id])
  resource     Resource? @relation(fields: [resourceId], references: [id])

  @@index([displayOrder])
  @@index([isActive])
  @@index([publishedAt])
  @@map("news")
}

model MembershipApplication {
  id                       String    @id @default(cuid())
  firstName                String
  lastName                 String
  email                    String
  country                  String?
  professionalGrade        String
  otherProfessionalGrade   String?
  medicalSpecialty         String
  academicDegree           String?
  institutionalAffiliation String
  membershipType           String
  researchInterests        String
  gdprConsent              Boolean   @default(false)
  feeConsent               Boolean   @default(false)
  newsletterConsent        Boolean   @default(false)
  status                   String    @default("pending")
  reviewedAt               DateTime?
  reviewNotes              String?
  createdAt                DateTime  @default(now())
  updatedAt                DateTime  @updatedAt

  @@index([status])
  @@index([createdAt])
  @@index([email])
  @@map("membership_applications")
}
